# Текущая структура репозитория - Анализ

## Обзор

Репозиторий представляет собой систему автоматизации медицинских новостей с FastAPI backend и Next.js frontend.

## Текущая структура

```
/
├── backend/
│   ├── api/              # FastAPI роутеры
│   ├── core/             # Конфигурация и основные компоненты
│   ├── database/         # Модели и миграции БД
│   ├── middleware/       # Middleware компоненты
│   ├── models/           # Pydantic/SQLModel модели
│   ├── services/         # Бизнес-логика
│   ├── storage/          # Статические файлы (изображения)
│   └── main.py          # Точка входа
├── frontend/
│   ├── components/       # React компоненты
│   ├── contexts/         # React контексты
│   ├── pages/           # Next.js страницы
│   ├── public/          # Статические ресурсы
│   ├── styles/          # CSS стили
│   └── utils/           # Утилиты
├── scripts/
│   └── backup/          # Скрипты резервного копирования
└── docs/               # Документация (создана)
```

## Выявленные проблемы

### 1. Структурные проблемы

- **Дублирование моделей**: `/backend/models/` и `/backend/database/` содержат модели
- **Смешение слоёв**: в `main.py` есть бизнес-логика планировщиков
- **Отсутствие алиасов**: Frontend использует относительные импорты (`../utils/api`)
- **Отсутствие TypeScript**: Frontend написан на JavaScript без типизации

### 2. Проблемы импортов

- **Frontend**: 23 файла используют относительные импорты `../`
- **Backend**: Импорты корректные (абсолютные от корня backend)
- **Отсутствие tsconfig.json** для настройки алиасов путей

### 3. Отсутствующие компоненты

- **ADR документация** для архитектурных решений
- **CI/CD проверки** структуры
- **Мониторинг** и **AI компоненты** не выделены в отдельные модули

## Рекомендации

### Целевая структура

```
/
├── backend/
│   ├── api/              # FastAPI endpoints (роутеры)
│   ├── core/             # Конфиги, запуск app, middleware, security
│   ├── services/         # Бизнес-логика (use-cases)
│   ├── database/         # Единое место для всех моделей, CRUD, сессий
│   ├── ai/               # AI провайдеры, routing, prompts
│   ├── monitoring/       # Метрики, логирование, трейсинг
│   └── main.py          # Минимальная точка входа
├── frontend/
│   ├── app/              # Next.js 13 app router (если нужно)
│   ├── components/       # React компоненты с подразделами
│   ├── hooks/            # Переиспользуемые хуки
│   ├── lib/              # API клиенты, утилиты
│   ├── styles/           # Стили и темы
│   ├── constants/        # Константы приложения
│   └── types/            # TypeScript типы (если мигрируем)
├── docs/
│   ├── architecture/     # Архитектурная документация
│   ├── api/              # API документация
│   └── adr/              # Architecture Decision Records
├── scripts/              # Утилиты и миграции
├── .github/workflows/    # CI/CD
└── CODEOWNERS           # Владение кодом
```

## Приоритеты реструктурирования

1. **Высокий приоритет**:
   - Настройка алиасов импортов для frontend
   - Консолидация моделей в `backend/database/`
   - Создание ADR документации

2. **Средний приоритет**:
   - Выделение AI компонентов
   - Настройка структурных проверок CI
   - Рефакторинг `main.py`

3. **Низкий приоритет**:
   - Миграция на TypeScript
   - Переход на Next.js 13 app router
   - Создание monitoring модуля

## Риски

- **Нарушение существующих импортов** при перемещении файлов
- **Возможные конфликты** при объединении моделей
- **Временная нестабильность** во время миграции

## Стратегия безопасной миграции

1. **Алиасы сначала**: настроить алиасы без перемещения файлов
2. **Пошаговые изменения**: по одному модулю за раз
3. **Обратная совместимость**: сохранить старые пути через re-export
4. **Тестирование**: проверять работоспособность на каждом шаге