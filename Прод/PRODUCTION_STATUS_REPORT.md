# Production Status Report - Medical News Automation System
**–î–∞—Ç–∞:** 30 –æ–∫—Ç—è–±—Ä—è 2025, 11:35 –ú–°–ö
**–°–µ—Ä–≤–µ—Ä:** 176.124.219.201
**–î–æ–º–µ–Ω:** https://admin.news.rmevent.ru

---

## üìä Executive Summary

–°–∏—Å—Ç–µ–º–∞ **Medical News Automation** —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Å uptime 24 –¥–Ω—è. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –°–µ–≥–æ–¥–Ω—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

### –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤: ‚úÖ –í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- **Backend:** ‚úÖ Healthy (FastAPI + PostgreSQL)
- **Frontend:** ‚ö†Ô∏è Unhealthy (–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–µ—Ä–µ–∑ nginx)
- **Nginx:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (SSL + reverse proxy)
- **Database:** ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∞ (PostgreSQL 16 –Ω–∞ –≤–Ω–µ—à–Ω–µ–º —Ö–æ—Å—Ç–µ)

---

## üê≥ Docker Containers Status

| Container | Status | CPU | Memory | Image |
|-----------|--------|-----|--------|-------|
| medical-news-backend | ‚úÖ Healthy | 0.28% | 100.1 MB | ghcr.io/dlutsok/medical-news-backend:latest |
| medical-news-frontend | ‚ö†Ô∏è Unhealthy | 0.00% | 35.48 MB | ghcr.io/dlutsok/medical-news-frontend:latest |
| medical-news-nginx | ‚úÖ Running | 0.00% | 4.38 MB | ghcr.io/dlutsok/medical-news-nginx:latest |
| db-health-check | ‚úÖ Running | 0.00% | 556 KB | postgres:16-alpine |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Frontend –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ "unhealthy" –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ healthcheck (—Å–ª—É—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ Docker network IP), –Ω–æ **—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** —á–µ—Ä–µ–∑ nginx.

---

## üíæ Disk & Storage

### System Resources
- **–î–∏—Å–∫:** 50GB total, 7.4GB used (16%), **42GB —Å–≤–æ–±–æ–¥–Ω–æ** ‚úÖ
- **RAM:** 3.8GB total, 775MB used, **3.1GB —Å–≤–æ–±–æ–¥–Ω–æ** ‚úÖ
- **Swap:** –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (0B)
- **Load Average:** 0.07, 0.07, 0.04 (–Ω–∏–∑–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)

### Docker Storage
- **Images:** 909.1MB (4 –æ–±—Ä–∞–∑–∞)
- **Containers:** 5.61MB
- **Volumes:** 12 volumes, 1 –∞–∫—Ç–∏–≤–Ω—ã–π

### Image Storage
- **–ü—É—Ç—å:** `/opt/medical-news/deployed/storage/images/`
- **–†–∞–∑–º–µ—Ä:** 297 MB
- **–§–∞–π–ª–æ–≤:** 234 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Volume:** ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω (`./storage/images:/app/storage/images`)

---

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Å–µ–≥–æ–¥–Ω—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–†–ï–®–ï–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑ Yandex Cloud ML —É—Å–ø–µ—à–Ω–æ
- –ù–æ –ø–æ–ª—É—á–∞–ª–∏ 404 Not Found –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
- –ü—Ä–∏—á–∏–Ω–∞: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π proxy_pass –≤ nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```nginx
# –ë—ã–ª–æ:
location /images/ {
    proxy_pass http://backend:8000/api/images/storage/images/;
}

# –°—Ç–∞–ª–æ:
location /images/ {
    proxy_pass http://backend:8000/images/;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `https://admin.news.rmevent.ru/images/{filename}.jpeg`

---

### 2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω Docker Volume –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ cleanup script) –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ—Ä—è–ª–∏—Å—å

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–ª–µ–Ω volume –≤ `docker-compose.yml`:
```yaml
volumes:
  - ./storage/images:/app/storage/images  # –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ –∏ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ

---

### 3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π cleanup

**–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç:** `/opt/medical-news/deployed/daily-cleanup.sh`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
2. –û—á–∏—â–∞–µ—Ç Docker –∫—ç—à (images, containers, volumes, build cache)
3. –û—á–∏—â–∞–µ—Ç –ª–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
5. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç health status
6. –ü–∏—à–µ—Ç –æ—Ç—á–µ—Ç –≤ `/var/log/medical-news-cleanup.log`

**Cron —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ:**
```bash
0 3 * * * /opt/medical-news/deployed/daily-cleanup.sh
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 –ú–°–ö —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è

---

### 4. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω timeout –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Timeout middleware: 60 —Å–µ–∫—É–Ω–¥
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è + AI —Å—Ç–∞—Ç—å—è: ~70 —Å–µ–∫—É–Ω–¥
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 408 Request Timeout

**–†–µ—à–µ–Ω–∏–µ –≤ `main.py`:**
```python
elif request.url.path.startswith("/api/news-generation/regenerate-image"):
    timeout = 120  # 2 –º–∏–Ω—É—Ç—ã –¥–ª—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
elif request.url.path.startswith("/api/images/generate"):
    timeout = 120  # 2 –º–∏–Ω—É—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ Timeout'—ã –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç

---

## üîê Security & Configuration

### Environment Variables (–ø—Ä–æ–≤–µ—Ä–µ–Ω—ã)
- ‚úÖ `DATABASE_URL` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –Ω–∞ 172.17.0.1:5432
- ‚úÖ `OPENAI_API_KEY` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `OPENAI_PROXY_URL` - http://GunetAyL:***@154.196.32.159:62904
- ‚úÖ `YC_FOLDER_ID` - b1gg98bnfm9rfef2ulk0 (Yandex Cloud)
- ‚úÖ `YC_API_KEY` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `IMAGE_SERVICE_PUBLIC_BASE_URL` - https://admin.news.rmevent.ru

### SSL Certificates
- ‚úÖ Let's Encrypt –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã: `/etc/letsencrypt/live/admin.news.rmevent.ru/`
- ‚úÖ HTTPS —Ä–µ–¥–∏—Ä–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç (HTTP 307)

---

## üìà Current Activity (–ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å)

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```
11:26:15 - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è: —Ç–æ–Ω–∫–∏–π –∏–Ω—Å—É–ª–∏–Ω–æ–≤—ã–π —à–ø—Ä–∏—Ü –∏ —Ç–∞–±–ª–µ—Ç–∫–∏...
11:26:26 - ‚úÖ –£—Å–ø–µ—à–Ω–æ: 88363a5f3126466f9042eec7a4f699a8.jpeg

11:32:57 - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è: —Ç–æ–Ω–∫–∏–π –∏–Ω—Å—É–ª–∏–Ω–æ–≤—ã–π —à–ø—Ä–∏—Ü –∏ —Ç–∞–±–ª–µ—Ç–∫–∏...
11:33:08 - ‚úÖ –£—Å–ø–µ—à–Ω–æ: 05f8ded743f045a9ae024960199e17da.jpeg

11:33:33 - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è: –ì—Ä–∞–Ω–∞—Ç...
```

### –ü—É–±–ª–∏–∫–∞—Ü–∏–∏
```
11:33:02 - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π
11:33:02 - –ù–∞–π–¥–µ–Ω–æ: 0 —Å—Ç–∞—Ç–µ–π –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
11:33:02 - –ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
```

---

## ‚è∞ Automated Jobs

### 1. Publication Cron (–ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
```bash
* * * * * /root/scripts/cron_publish_news.sh
```
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- **–ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫:** 11:33:02
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 0 —Å—Ç–∞—Ç–µ–π –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ (–Ω–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö)

### 2. Daily Cleanup (–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00)
```bash
0 3 * * * /opt/medical-news/deployed/daily-cleanup.sh
```
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω
- **–ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫:** 11:16:13 (—Ä—É—á–Ω–æ–π —Ç–µ—Å—Ç)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å–ø–µ—à–Ω–æ

### 3. Daily News Parsing (–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00)
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- **–ù–∞—Å—Ç—Ä–æ–µ–Ω:** –í –∫–æ–¥–µ backend (`services/scheduler.py`)
- **–°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫:** 31 –æ–∫—Ç—è–±—Ä—è 2025, 02:00 –ú–°–ö

---

## üß™ Health Check Results

| Endpoint | Status | Response |
|----------|--------|----------|
| http://localhost:8000/health | ‚úÖ 200 | `{"status":"healthy","service":"medical-news-automation"}` |
| https://admin.news.rmevent.ru | ‚úÖ 307 | Redirect to HTTPS |
| https://admin.news.rmevent.ru/images/*.jpeg | ‚úÖ 200 | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã |

---

## üìã Known Issues & Workarounds

### 1. Frontend Healthcheck (‚ö†Ô∏è –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
medical-news-frontend   Up 4 minutes (unhealthy)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- Next.js —Å–ª—É—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ Docker network IP (172.18.0.4:3000)
- Healthcheck –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ localhost:3000
- curl –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

**–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ:** –ù–ï–¢ - —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–µ—Ä–µ–∑ nginx

**–í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–Ω–µ —Å—Ä–æ—á–Ω–æ):**
```yaml
# docker-compose.yml
healthcheck:
  test: ["CMD", "curl", "-f", "http://172.18.0.4:3000"]  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker IP
```

---

### 2. Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ (‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–¥–µ–ª–∞–Ω–æ **–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**
- –ü—Ä–∏ rebuild Docker image –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ç–µ—Ä—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è `nginx-server.conf` —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ ‚úÖ
2. –ù—É–∂–Ω–æ –∑–∞–ø—É—à–∏—Ç—å –≤ GitHub
3. –î–æ–∂–¥–∞—Ç—å—Å—è rebuild —á–µ—Ä–µ–∑ GitHub Actions
4. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: `docker compose pull && docker compose up -d`

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
cd "/Users/dan/Documents/RM Service/SEO NEW 5"
git add nginx-server.conf
git commit -m "fix: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω proxy_pass –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ nginx"
git push origin main

# –ü–æ–¥–æ–∂–¥–∞—Ç—å GitHub Actions (5-10 –º–∏–Ω—É—Ç)

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
ssh root@176.124.219.201
cd /opt/medical-news/deployed
docker compose pull nginx
docker compose up -d nginx
```

---

## üéØ Recommendations

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **‚úÖ –í–´–ü–û–õ–ù–ï–ù–û:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å volume –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. **‚úÖ –í–´–ü–û–õ–ù–ï–ù–û:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π cleanup
3. **‚è≥ TODO:** –ó–∞–ø—É—à–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π nginx-server.conf –≤ GitHub

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - Prometheus + Grafana –¥–ª—è –º–µ—Ç—Ä–∏–∫
   - Alerting –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Swap:**
   ```bash
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)
   sudo fallocate -l 2G /swapfile
   sudo chmod 600 /swapfile
   sudo mkswap /swapfile
   sudo swapon /swapfile
   echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
   ```

6. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ª–æ–≥–æ–≤:**
   - –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ nginx (—Å–µ–π—á–∞—Å –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞)
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ Docker logs

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

7. –ò—Å–ø—Ä–∞–≤–∏—Ç—å healthcheck –¥–ª—è frontend (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É)
8. –û–±–Ω–æ–≤–∏—Ç—å `version: '3.8'` –≤ docker-compose.yml (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä)
9. –î–æ–±–∞–≤–∏—Ç—å backup –ë–î (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π pg_dump)

---

## üìä Performance Metrics

### Response Times (—Å—Ä–µ–¥–Ω–∏–µ)
- Backend API: < 100ms
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç—å–∏ AI: ~30-60 —Å–µ–∫—É–Ω–¥
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è YandexART: ~10-15 —Å–µ–∫—É–Ω–¥
- –ü–æ–ª–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (—Å—Ç–∞—Ç—å—è + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ): ~60-90 —Å–µ–∫—É–Ω–¥

### System Load
- CPU: 0.07 (–æ—á–µ–Ω—å –Ω–∏–∑–∫–∞—è)
- Memory: 20% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ
- Disk I/O: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

---

## üîÑ Deployment Process

### –¢–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (GitHub Actions ‚Üí Docker Hub ‚Üí Server)

1. **Push –≤ GitHub:**
   ```bash
   git add .
   git commit -m "–æ–ø–∏—Å–∞–Ω–∏–µ"
   git push origin main
   ```

2. **GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
   - –°–æ–±–∏—Ä–∞–µ—Ç Docker images
   - –ü—É–±–ª–∏–∫—É–µ—Ç –≤ GitHub Container Registry (ghcr.io)
   - –ó–∞–Ω–∏–º–∞–µ—Ç 5-10 –º–∏–Ω—É—Ç

3. **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   cd /opt/medical-news/deployed
   docker compose pull
   docker compose up -d
   ```

---

## üìû Support & Contacts

### Logs locations
- **Backend:** `docker logs medical-news-backend`
- **Frontend:** `docker logs medical-news-frontend`
- **Nginx:** `docker logs medical-news-nginx`
- **Cleanup:** `/var/log/medical-news-cleanup.log`
- **Publication:** `/root/logs/publication_cron.log`

### Useful Commands
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker ps
docker compose ps

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker compose restart backend
docker compose restart frontend
docker compose restart nginx

# –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose down && docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker logs -f medical-news-backend
docker logs -f --tail 100 medical-news-backend

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:8000/health
curl https://admin.news.rmevent.ru

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ (—Ä—É—á–Ω–∞—è)
bash /opt/medical-news/deployed/daily-cleanup.sh
```

---

## ‚úÖ Testing Checklist

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ —Å–µ–≥–æ–¥–Ω—è (30 –æ–∫—Ç—è–±—Ä—è 2025):

- [x] Backend API –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ /health
- [x] Frontend –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ HTTPS
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ /images/
- [x] Volume –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- [x] Cron –¥–ª—è cleanup –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Cron –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã
- [x] Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [x] Database –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìù Changelog (30 –æ–∫—Ç—è–±—Ä—è 2025)

### Added
- ‚úÖ Docker volume –¥–ª—è persistent storage –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π cleanup script –≤ cron (03:00 –ú–°–ö)
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π timeout –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (120 —Å–µ–∫)

### Fixed
- ‚úÖ Nginx proxy_pass –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–±—ã–ª–æ: `/api/images/storage/images/`, —Å—Ç–∞–ª–æ: `/images/`)
- ‚úÖ 404 Not Found –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º
- ‚úÖ –ü–æ—Ç–µ—Ä—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### Changed
- ‚úÖ Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–¥–æ–±–∞–≤–ª–µ–Ω volume)
- ‚úÖ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω –ø—É—Ç—å –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

---

**–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:** ‚úÖ **Production Ready**
**–°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** 31 –æ–∫—Ç—è–±—Ä—è 2025 –ø–æ—Å–ª–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤ 02:00 –ú–°–ö

---

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ Claude Code*
*–í–µ—Ä—Å–∏—è: 1.0*
*–î–∞—Ç–∞: 2025-10-30*
